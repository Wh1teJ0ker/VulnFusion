# VulnFusion

## 系统逻辑架构图

```undefined
                        +------------------------+
                        |  CLI / Web 控制入口     |
                        +-----------+------------+
                                    |
                             +------v------+
                             |  调度器核心   | <----------------------------+
                             +------+------+\                             |
                                    |       \                             |
    +-------------------------------+--------\----------------+           |
    |                                |                         |           |
+---v---+                   +--------v-------+         +-------v------+   |
| 目标管理 |                | 插件执行模块     |         | 漏洞情报模块  |   |
+---+---+                   +--------+-------+         +-------+------+   |
    |                              |                             |       |
+---v------------------+   +-------v---------+         +---------v----+  |
| nuclei 模板引擎       |   | 脚本插件执行器    |         | GitHub CVE插件 |  |
+----------------------+   +-----------------+         +--------------+  |
                                                                         |
+-------------------------+                                      +------v--------+
| 扫描结果处理模块         |  <-----------------------------------  | 缓存 / 导出模块 |
+-------------------------+                                      +---------------+

```
### 插件模块

```
                +---------------------------+
                |       主程序调度器        |
                +------------+--------------+
                             |
                     docker run 调用
                             |
        +--------------------+----------------------+
        |                   |                      |
+-------v-------+  +--------v--------+    +--------v--------+
| Python 插件容器 |  | Shell 插件容器  |    | Go 插件容器     |
| VulnPoc:py     |  | VulnPoc:sh      |    | VulnPoc:go       |
+---------------+  +-----------------+    +------------------+

```
## 系统目录设计

```undefined
VulnFusion/
├── cmd/                        # 启动入口模块
│   ├── web.go                  # 启动 Web UI
│   └── cli.go                  # CLI 模式入口
│
├── core/                       # 核心调度器模块
│   └── dispatcher.go           # 调度器主逻辑
│
├── internal/                  # 各核心模块实现
│   ├── scanner/               # 扫描控制（接管 nuclei / 插件调度）
│   │   └── scanner.go
│   ├── plugin/                # 动态插件执行（Python / Bash / Go）
│   │   ├── runner.go
│   │   └── loader.go
│   ├── nuclei/                # nuclei 集成模块
│   │   └── runner.go
│   ├── result/                # 扫描结果处理与导出
│   │   ├── handler.go
│   │   └── exporter.go
│   ├── vulnfeed/              # 漏洞情报模块
│   │   ├── github.go          # GitHub CVE 情报爬虫
│   │   ├── interface.go       # FeedPlugin 接口定义
│   │   └── register.go        # 插件注册器
│   └── config/                # 配置解析器（支持 yaml）
│       └── config.go
│
├── web/                       # Web UI 路由与服务
│   ├── server.go              # 启动 Gin 并绑定 API
│   └── ui/                    # 前端静态文件目录（Vue / React）
│
├── log/                       # 日志系统模块（zap + lumberjack）
│   ├── logger.go
│   └── config.go
│
├── data/                      # 所有输出数据目录（建议持久化挂载）
│   ├── logs/                  # 日志文件目录
│   ├── output/                # 扫描结果存储
│   └── vuln_cache/            # CVE 数据缓存
│
├── plugins/                   # 用户自定义脚本插件目录
│   ├── demo.py
│   └── test.sh
│
├── templates/                 # nuclei 模板（可更新同步）
├── targets.txt                # 扫描目标资产列表
├── config.yaml                # 全局配置文件
├── main.go                    # 主入口（调用 cmd）
├── go.mod
└── go.sum


```